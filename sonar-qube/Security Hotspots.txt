Make sure that using this pseudorandom number generator is safe here.
î…—
Using pseudorandom number generators (PRNGs) is security-sensitivetypescript:S2245
Status: To Review
This Security Hotspot needs to be reviewed to assess whether the code poses a risk.

Review
Review priority:
Medium
Category:
Weak Cryptography
Assignee:
Not assigned
Where is the risk?
Activity
src/app/page.tsx


Show 316 more lines
    if (available.length === 0) {
      showToast('No available emails!', 'error')
      return
    }
    const random = available[Math.floor(Math.random() * available.length)]
Make sure that using this pseudorandom number generator is safe here.

    // Mark as used immediately
    updateEmail(random.id, { isUsed: true, usedAt: new Date().toISOString() })
    loadEmails()


Show 1124 more lines

whats the risk?
PRNGs are algorithms that produce sequences of numbers that only approximate true randomness. While they are suitable for applications like simulations or modeling, they are not appropriate for security-sensitive contexts because their outputs can be predictable if the internal state is known.

In contrast, cryptographically secure pseudorandom number generators (CSPRNGs) are designed to be secure against prediction attacks. CSPRNGs use cryptographic algorithms to ensure that the generated sequences are not only random but also unpredictable, even if part of the sequence or the internal state becomes known. This unpredictability is crucial for security-related tasks such as generating encryption keys, tokens, or any other values that must remain confidential and resistant to guessing attacks.

For example, the use of non-cryptographic PRNGs has led to vulnerabilities such as:

CVE-2013-6386
CVE-2006-3419
CVE-2008-4102
When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that will be generated, and use this guess to impersonate another user or access sensitive information. Therefore, it is critical to use CSPRNGs in any security-sensitive application to ensure the robustness and security of the system.

As the Math.random() function relies on a weak pseudorandom number generator, this function should not be used for security-critical applications or for protecting sensitive data. In such context, a cryptographically strong pseudorandom number generator (CSPRNG) should be used instead.

Assess the risk
Ask Yourself Whether
the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such as a password, is hashed.
the function you use is a non-cryptographic PRNG.
the generated value is used multiple times.
an attacker can access the generated value.
There is a risk if you answered yes to any of those questions.

How can I fix it?
Recommended Secure Coding Practices
Use a cryptographically secure pseudorandom number generator (CSPRNG) like crypto.getRandomValues().
Use the generated random values only once.
You should not expose the generated random value. If you have to store it, make sure that the database or file is secure.
Sensitive Code Example
const val = Math.random(); // Sensitive
// Check if val is used in a security context.
Compliant Solution
// === Client side ===
const crypto = window.crypto || window.msCrypto;
var array = new Uint32Array(1);
crypto.getRandomValues(array);

// === Server side ===
const crypto = require('crypto');
const buf = crypto.randomBytes(1);

Activity
Activity

Add a comment
December 9, 2025 at 4:35 PM
verifydream@example.com
Created Security Hotspot